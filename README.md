# ml_hw1
## Почему-то дока получилась некрасивая, поэтому сначала скриншоты из постмана

![image](https://github.com/maxodum/ml_hw1/assets/77792873/b06f95a9-2215-4920-b005-ee2e4f1604c8)

![image](https://github.com/maxodum/ml_hw1/assets/77792873/61820a9c-2cc0-4f1d-9981-601498163fe3)

![image](https://github.com/maxodum/ml_hw1/assets/77792873/786cc6fe-a442-4852-81e5-51b8a015a70c)

![image](https://github.com/maxodum/ml_hw1/assets/77792873/6761b1e5-e025-4813-9daa-f64946a8cd03)

## Теперь отчет
Не знаю, нужно ли описывать все шаги из ноутбука, но все же:
  1) Подготовка данных. Загрузил, удалил дубли, заполнил пропуски, отформатировал.
  2) EDA. Построил pairplot, смотрел, в основном, на целевую переменную и как с ней коррелируют другие. Вставлю кусок из ноутбука:
       Исходя из графиков можно предположить следующие зависимости:
        1.   Цена зависит от года выпуска, так как старые автомобили почти не бывают дорогими, а новые бывают.
        2.   Высокая цена наблюдается только у автомобилей с низким пробегом.
        3.   Расход топлива имеет некоторую связь с ценой, но она точно не линейная.
        4.   Чем больше объем, тем выше предельная стоимость.
        5.   То же самое можно сказать про лошадиные силы.
        6.   Зависимость цены от количества мест не ясна, возомжно слишком большое или низкое значение соответсвтует машинам с более низкой стоимостью.

    Также оценил корреляцию признаков: самую скоррелированную пару, кажется, составляют max_power и engine (довольно логично).
    Дополнительно посторил boxplot. Выбросы были в целевой переменной и пробеге.
  3) Построил модель на вещественных признаках. Наибольший вклад в цену внес год выпуска.
     Использовал L1 регуляризацию с дефолтными параметрами (т.е.) alpha=1, она не оказала большого эффекта, так как признаков мало, а сама альфа небольшая.
     Затем GridSearch подобрал alpha в районе 26000 и занулил несколько переменных (mileage, engine и seats). Качество упало(
     Использование ElasticNet тоже не дало особого результата.
     Добавление категориальных фичей и использование Ridge регуляризации же дали существенный буст к результату. Введение категориальных признаков привело к тому, что у нас появилось больше данных для составления зависимостей, а Ridge позволяет регулировать, которые из них более нужны, не зануляя.
  4) Дальше feature engineering.
     1. Удалил выбросы. Удалил только выбросы с пробегом, так как удаление выбросов из целевой переменной негативно сказалось на скоре (я проверил, но удалил, простите:( ) Дало прирост в районе 0.01 к r^2
     2. Добавил предложенные признаки и дропнул скоррелированный year. Опять же, метрика немного выросла, тоже в районе 0.01.
  5) Сделал сервис

Что еще можно было бы сделать:
  1) Пологорифмировать. У меня всегда проблема с определением того, что нужно логорифмировать, поэтому не сделал, но кажется, что с целевой переменной можно попробовать.
  2) Парсинг моделей автомобилей.
  3) Дополнительная чистка данных.
     
     
